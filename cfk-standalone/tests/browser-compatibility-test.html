<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser Compatibility Test - Christmas for Kids</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 1000px;
            margin: 2rem auto;
            padding: 0 1rem;
            line-height: 1.6;
        }
        h1 { color: #2c5530; }
        .test-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 2rem 0;
        }
        .test-card {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            background: white;
        }
        .status {
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-weight: bold;
            margin: 0.5rem 0;
        }
        .pass { background: #d4edda; color: #155724; }
        .fail { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .browser-info {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 4px;
            margin: 1rem 0;
            font-family: monospace;
            font-size: 0.9rem;
        }
        button {
            background: #2c5530;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            margin: 0.5rem 0.5rem 0.5rem 0;
        }
        button:hover {
            background: #1e3a21;
        }
        .feature-list {
            list-style: none;
            padding: 0;
        }
        .feature-list li {
            padding: 0.5rem;
            margin: 0.25rem 0;
            border-radius: 4px;
        }
        .feature-list li.supported {
            background: #d4edda;
        }
        .feature-list li.unsupported {
            background: #f8d7da;
        }
        @media (max-width: 768px) {
            .test-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <h1>üéÑ Browser Compatibility Test</h1>
    <p>This page tests whether your browser supports all the features used by the Christmas for Kids sponsorship system.</p>

    <div class="browser-info">
        <strong>Your Browser:</strong> <span id="browserInfo"></span><br>
        <strong>Screen Size:</strong> <span id="screenInfo"></span><br>
        <strong>Device Type:</strong> <span id="deviceType"></span>
    </div>

    <button onclick="runTests()">Run Compatibility Tests</button>
    <button onclick="testLocalStorage()">Test Shopping Cart</button>
    <button onclick="copyResults()">Copy Results</button>

    <div id="results"></div>

    <h2>Feature Support</h2>
    <ul class="feature-list" id="featureList"></ul>

    <h2>Visual Tests</h2>
    <div class="test-grid">
        <div class="test-card">
            <h3>CSS Grid Test</h3>
            <p>This card should be next to another card on desktop.</p>
        </div>
        <div class="test-card">
            <h3>Flexbox Test</h3>
            <p>Both cards should be side-by-side on wide screens.</p>
        </div>
    </div>

    <div class="test-card" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 1rem;">
        <div style="background: #2c5530; color: white; padding: 1rem; border-radius: 4px; flex: 1;">
            Flex Item 1
        </div>
        <div style="background: #4a7c4e; color: white; padding: 1rem; border-radius: 4px; flex: 1;">
            Flex Item 2
        </div>
    </div>

    <h2>How to Use</h2>
    <ol>
        <li>Click "Run Compatibility Tests" button above</li>
        <li>Review the results for any failed tests</li>
        <li>Click "Copy Results" to share with the developer</li>
        <li>Test on different devices (phone, tablet, desktop)</li>
    </ol>

    <script>
        // Detect browser and device info
        function detectBrowser() {
            const ua = navigator.userAgent;
            let browserName = 'Unknown';
            let version = 'Unknown';

            if (ua.indexOf('Chrome') > -1 && ua.indexOf('Edg') === -1 && ua.indexOf('OPR') === -1) {
                browserName = 'Chrome';
                version = ua.match(/Chrome\/([0-9.]+)/)?.[1];
            } else if (ua.indexOf('Edg') > -1) {
                browserName = 'Edge';
                version = ua.match(/Edg\/([0-9.]+)/)?.[1];
            } else if (ua.indexOf('Safari') > -1 && ua.indexOf('Chrome') === -1) {
                browserName = 'Safari';
                version = ua.match(/Version\/([0-9.]+)/)?.[1];
            } else if (ua.indexOf('Firefox') > -1) {
                browserName = 'Firefox';
                version = ua.match(/Firefox\/([0-9.]+)/)?.[1];
            } else if (ua.indexOf('SamsungBrowser') > -1) {
                browserName = 'Samsung Internet';
                version = ua.match(/SamsungBrowser\/([0-9.]+)/)?.[1];
            } else if (ua.indexOf('OPR') > -1 || ua.indexOf('Opera') > -1) {
                browserName = 'Opera';
                version = ua.match(/(?:OPR|Opera)\/([0-9.]+)/)?.[1];
            }

            return { name: browserName, version: version };
        }

        function detectDevice() {
            const width = window.innerWidth;
            if (width < 768) return 'Mobile';
            if (width < 1024) return 'Tablet';
            return 'Desktop';
        }

        // Display browser info
        const browser = detectBrowser();
        document.getElementById('browserInfo').textContent = `${browser.name} ${browser.version}`;
        document.getElementById('screenInfo').textContent = `${window.innerWidth}x${window.innerHeight}`;
        document.getElementById('deviceType').textContent = detectDevice();

        // Test suite
        const tests = [
            {
                name: 'CSS Grid Support',
                test: () => CSS.supports('display', 'grid'),
                required: true
            },
            {
                name: 'CSS Flexbox Support',
                test: () => CSS.supports('display', 'flex'),
                required: true
            },
            {
                name: 'CSS Custom Properties',
                test: () => CSS.supports('--custom', 'value'),
                required: true
            },
            {
                name: 'LocalStorage (Shopping Cart)',
                test: () => {
                    try {
                        localStorage.setItem('test', 'test');
                        localStorage.removeItem('test');
                        return true;
                    } catch (e) {
                        return false;
                    }
                },
                required: true
            },
            {
                name: 'ES6 Arrow Functions',
                test: () => {
                    try {
                        eval('() => {}');
                        return true;
                    } catch (e) {
                        return false;
                    }
                },
                required: true
            },
            {
                name: 'ES6 const/let',
                test: () => {
                    try {
                        eval('const x = 1; let y = 2;');
                        return true;
                    } catch (e) {
                        return false;
                    }
                },
                required: true
            },
            {
                name: 'Template Literals',
                test: () => {
                    try {
                        eval('`test ${1}`');
                        return true;
                    } catch (e) {
                        return false;
                    }
                },
                required: true
            },
            {
                name: 'querySelector API',
                test: () => typeof document.querySelector === 'function',
                required: true
            },
            {
                name: 'addEventListener API',
                test: () => typeof window.addEventListener === 'function',
                required: true
            },
            {
                name: 'JSON Support',
                test: () => typeof JSON !== 'undefined' && typeof JSON.parse === 'function',
                required: true
            }
        ];

        function runTests() {
            const resultsDiv = document.getElementById('results');
            const featureList = document.getElementById('featureList');

            let html = '<h2>Test Results</h2>';
            let allPassed = true;
            let results = [];

            tests.forEach(test => {
                const passed = test.test();
                const status = passed ? 'PASS' : 'FAIL';
                const statusClass = passed ? 'pass' : 'fail';

                if (!passed && test.required) {
                    allPassed = false;
                }

                html += `<div class="status ${statusClass}">${test.name}: ${status}</div>`;
                results.push(`${test.name}: ${status}`);

                // Add to feature list
                const li = document.createElement('li');
                li.textContent = `${test.name}: ${passed ? '‚úÖ Supported' : '‚ùå Not Supported'}`;
                li.className = passed ? 'supported' : 'unsupported';
                featureList.appendChild(li);
            });

            if (allPassed) {
                html += '<div class="status pass">‚úÖ All tests passed! Your browser is fully compatible.</div>';
            } else {
                html += '<div class="status fail">‚ùå Some tests failed. Your browser may not support all features.</div>';
            }

            resultsDiv.innerHTML = html;

            // Store results for copying
            window.testResults = {
                browser: browser,
                screen: `${window.innerWidth}x${window.innerHeight}`,
                device: detectDevice(),
                results: results,
                allPassed: allPassed
            };
        }

        function testLocalStorage() {
            try {
                // Test shopping cart functionality
                const testChild = {
                    id: 999,
                    display_id: 'TEST-1A',
                    age: 10,
                    gender: 'M'
                };

                localStorage.setItem('cfk_test_cart', JSON.stringify([testChild]));
                const retrieved = JSON.parse(localStorage.getItem('cfk_test_cart'));
                localStorage.removeItem('cfk_test_cart');

                if (retrieved && retrieved[0].id === 999) {
                    alert('‚úÖ Shopping cart functionality works!\n\nYour browser can save selections.');
                } else {
                    alert('‚ùå Shopping cart test failed!\n\nData was corrupted.');
                }
            } catch (e) {
                alert('‚ùå Shopping cart test failed!\n\nError: ' + e.message);
            }
        }

        function copyResults() {
            if (!window.testResults) {
                alert('Please run the tests first!');
                return;
            }

            const text = `Browser Compatibility Test Results
===========================================
Browser: ${window.testResults.browser.name} ${window.testResults.browser.version}
Screen: ${window.testResults.screen}
Device: ${window.testResults.device}
Date: ${new Date().toISOString()}

Test Results:
${window.testResults.results.join('\n')}

Overall: ${window.testResults.allPassed ? 'PASS' : 'FAIL'}
`;

            // Copy to clipboard
            navigator.clipboard.writeText(text).then(() => {
                alert('‚úÖ Results copied to clipboard!\n\nPaste them in an email or message.');
            }).catch(() => {
                // Fallback for older browsers
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('‚úÖ Results copied to clipboard!\n\nPaste them in an email or message.');
            });
        }

        // Run tests automatically on load
        window.addEventListener('load', () => {
            runTests();
        });
    </script>
</body>
</html>
