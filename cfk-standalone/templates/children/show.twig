{# Child Profile Template #}

<div class="child-profile-page">
    {# Breadcrumb #}
    <nav class="breadcrumb">
        <a href="?page=children">All Children</a>
        <span>&raquo;</span>
        <span>Family {{ child.display_id }}</span>
    </nav>

    <div class="child-profile">
        <div class="profile-header">
            <div class="profile-photo">
                <img src="{{ getPhotoUrl(child.photo_filename, child) }}"
                     alt="Avatar for Family {{ child.display_id }}">
            </div>

            <div class="profile-basic-info">
                <h1>Family Code: {{ child.display_id }}</h1>
                <p class="child-id">ID: {{ child.display_id }}</p>

                <div class="basic-details">
                    <div class="detail-item">
                        <strong>Age:</strong> {{ formatAge(child.age_months) }}
                    </div>

                    <div class="detail-item">
                        <strong>Grade:</strong> {{ child.grade ?: 'Not specified' }}
                    </div>

                    <div class="detail-item">
                        <strong>Age Group:</strong> {{ getAgeCategory(child.age_months) }}
                    </div>

                    {% if child.school %}
                        <div class="detail-item">
                            <strong>School:</strong> {{ child.school }}
                        </div>
                    {% endif %}
                </div>

                {# Status Badge #}
                <div class="status-badge status-{{ child.status }}">
                    {{ childStatusOptions[child.status] ?? child.status|capitalize }}
                </div>
            </div>
        </div>

        {# Unavailable Warning #}
        {% if not isAvailable %}
            <div class="alert alert-warning">
                <h3>This child is no longer available for sponsorship</h3>
                <p>
                    {% if child.status == 'sponsored' %}
                        This child has already found a sponsor! Thank you to everyone who showed interest.
                    {% elseif child.status == 'pending' %}
                        This child's sponsorship is currently being processed by another family.
                    {% else %}
                        This child is not currently available for sponsorship.
                    {% endif %}
                </p>
                <a href="?page=children" class="btn btn-primary">
                    View Other Children
                </a>
            </div>
        {% endif %}

        <div class="profile-details">
            {# Clothing Sizes #}
            {% if child.shirt_size or child.pant_size or child.shoe_size or child.jacket_size %}
                <section class="detail-section">
                    <h2>Clothing Sizes</h2>
                    <div class="size-grid">
                        {% if child.shirt_size %}
                            <div class="size-item">
                                <strong>Shirt:</strong> {{ child.shirt_size }}
                            </div>
                        {% endif %}

                        {% if child.pant_size %}
                            <div class="size-item">
                                <strong>Pants:</strong> {{ child.pant_size }}
                            </div>
                        {% endif %}

                        {% if child.shoe_size %}
                            <div class="size-item">
                                <strong>Shoes:</strong> {{ child.shoe_size }}
                            </div>
                        {% endif %}

                        {% if child.jacket_size %}
                            <div class="size-item">
                                <strong>Jacket:</strong> {{ child.jacket_size }}
                            </div>
                        {% endif %}
                    </div>
                </section>
            {% endif %}

            {# Essential Needs #}
            {% if child.interests %}
                <section class="detail-section">
                    <h2>Essential Needs</h2>
                    <p class="interests-text">{{ child.interests|nl2br }}</p>
                </section>
            {% endif %}

            {# Christmas Wishes #}
            {% if child.wishes %}
                <section class="detail-section">
                    <h2>Christmas Wishes</h2>
                    <p class="wishes-text">{{ child.wishes|nl2br }}</p>
                </section>
            {% endif %}

            {# Special Needs #}
            {% if child.special_needs %}
                <section class="detail-section">
                    <h2>Special Considerations</h2>
                    <p class="special-needs-text">{{ child.special_needs|nl2br }}</p>
                </section>
            {% endif %}

            {# Family Information #}
            {% if siblings or child.family_notes %}
                <section class="detail-section">
                    <h2>Family Information</h2>

                    {% if siblings %}
                        <div class="siblings-section">
                            <h3>Siblings Also Needing Sponsorship</h3>
                            <div class="siblings-grid">
                                {% for sibling in siblings %}
                                    <div class="sibling-card">
                                        <div class="sibling-photo">
                                            <img src="{{ getPhotoUrl(sibling.photo_filename, sibling) }}"
                                                 alt="Avatar for {{ sibling.name }}">
                                        </div>
                                        <div class="sibling-info">
                                            <h4>{{ sibling.name }}</h4>
                                            <p>ID: {{ sibling.display_id }}</p>
                                            <p>{{ formatAge(sibling.age_months) }}</p>
                                            <div class="status-badge status-{{ sibling.status }}">
                                                {{ childStatusOptions[sibling.status] ?? sibling.status|capitalize }}
                                            </div>
                                            <a href="?page=child&id={{ sibling.id }}"
                                               class="btn btn-small btn-secondary">View Profile</a>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}

                    {% if child.family_notes %}
                        <div class="family-notes">
                            <h3>About the Family</h3>
                            <p>{{ child.family_notes|nl2br }}</p>
                        </div>
                    {% endif %}
                </section>
            {% endif %}
        </div>

        {# Sponsorship Action #}
        {% if availability.available %}
            <div class="sponsorship-action">
                <div class="action-content">
                    <h2>Sponsor Child {{ child.display_id }}</h2>
                    <p>Ready to make this child's Christmas special?
                       Click below to begin the sponsorship process.</p>

                    <a href="?page=sponsor&child_id={{ child.id }}"
                       class="btn btn-large btn-primary">
                        Sponsor This Child
                    </a>

                    {% if siblings %}
                        <p class="family-sponsor-note">
                            <strong>Consider sponsoring siblings together!</strong>
                            Keeping families connected during Christmas creates even more joy.
                        </p>

                        {% if availableSiblingsCount > 0 %}
                            <a href="?page=sponsor&family_id={{ child.family_id }}"
                               class="btn btn-large btn-success">
                                üéÅ Sponsor Entire Family ({{ availableSiblingsCount + 1 }} children)
                            </a>
                        {% endif %}

                        <a href="?page=children&family_id={{ child.family_id }}"
                           class="btn btn-secondary">
                            View All Family Members
                        </a>
                    {% endif %}
                </div>
            </div>
        {% else %}
            <div class="sponsorship-unavailable">
                <div class="alert alert-warning">
                    <h2>Sponsorship Status</h2>
                    <p><strong>{{ availability.reason }}</strong></p>
                    <p>This child is no longer available for new sponsorship requests.</p>
                    <a href="?page=children" class="btn btn-primary">
                        Browse Other Children
                    </a>
                </div>
            </div>
        {% endif %}

        {# Other Ways to Help #}
        <div class="other-help">
            <h2>Other Ways to Help</h2>
            <p>Not ready to sponsor a specific child? You can still make a difference:</p>
            <div class="help-options">
                <a href="?page=children" class="btn btn-secondary">
                    Browse Other Children
                </a>
                <a href="?page=donate" class="btn btn-success">
                    Make a General Donation
                </a>
            </div>
        </div>
    </div>
</div>
